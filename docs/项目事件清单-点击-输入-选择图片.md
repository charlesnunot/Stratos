# Stratos 项目事件清单：点击 / 输入 / 选择图片

> 系统性梳理项目中所有 onClick、onChange、onSubmit、图片选择等用户交互事件

---

## 一、点击事件 (onClick)

### 1. 认证与错误页
| 文件 | 事件 | 说明 |
|------|------|------|
| [app/error.tsx](src/app/error.tsx) | onClick={reset} | 错误页重试 |
| [app/(main)/error.tsx](src/app/[locale]/(main)/error.tsx) | onClick={reset} | 主区错误页重试 |
| [app/global-error.tsx](src/app/global-error.tsx) | onClick={reset} | 全局错误页重试 |

### 2. 帖子 (Post)
| 文件 | 事件 | 说明 |
|------|------|------|
| PostCardView / PostCard | onClick={handleOpenPost} | 打开帖子详情 |
| PostCardView / PostCard | onClick={handleCardClick} | 卡片点击 |
| PostCardView / PostCard | onClick={handleEditPost} | 编辑帖子 |
| PostCardView / PostCard | onClick={handleViewStats} | 查看统计 |
| PostCardView / PostCard | onClick={handleDeleteClick} | 删除帖子 |
| PostCardView / PostCard | onClick={handleReportClick} | 举报 |
| PostCardView / PostCard | onClick={handleUnfollowClick} | 取消关注 |
| PostCardView / PostCard | onClick={handleShareTo} | 分享到 |
| PostCardView / PostCard | onClick={handleRepost} | 转发 |
| PostCardView / PostCard | onClick={handleCopyLink} | 复制链接 |
| post/create/page | onClick={() => removeImage(index)} | 移除帖子图片 |
| post/create/page | onClick={handleExtractTopics} | 提取话题 |
| post/create/page | onClick={addTopic} | 添加话题 |
| post/create/page | onClick={() => removeTopic(topic)} | 移除话题 |
| post/create/page | onClick={fetchLocationFromIp} | 获取位置 |
| post/create/page | onClick={() => router.back()} | 返回 |

### 3. 评论 (Comment)
| 文件 | 事件 | 说明 |
|------|------|------|
| CommentSection | onClick={() => fileInputRef.current?.click()} | 触发图片选择 |
| CommentSection | onClick={onEdit} | 编辑评论 |
| CommentSection | onClick={onDelete} | 删除评论 |
| CommentSection | onClick={() => onRemoveEditImage(...)} | 移除编辑中图片 |
| CommentSection | onClick={() => onSaveEdit(comment.id)} | 保存编辑 |
| CommentSection | onClick={onCancelEdit} | 取消编辑 |
| CommentSection | onClick={() => window.open(imageUrl)} | 打开图片新窗口 |
| CommentSection | onClick={() => onReply(comment.id)} | 回复 |
| CommentSection | onClick={() => onReport(comment.id)} | 举报 |
| CommentSection | onClick={() => replyFileInputRef?.current?.click()} | 回复图片选择 |
| CommentSection | onClick={() => setIsExpanded(!isExpanded)} | 展开/收起 |
| CommentSection | onClick={() => fetchNextPage()} | 加载更多 |
| CommentSection | Button onClick (确认删除) | 确认删除评论 |

### 4. 社交按钮
| 文件 | 事件 | 说明 |
|------|------|------|
| LikeButton | onClick={handleLike} | 点赞 |
| FavoriteButton | onClick={handleFavorite} | 收藏 |
| FollowButton | (内部) | 关注/取消关注 |
| ChatButton | onClick={handleClick} | 打开聊天 |
| TipButton | (表单内) | 打赏 |
| UserTipButton | onClick={() => setShowModal(true)} | 打开打赏弹窗 |
| UserTipButton | onClick={handleTip} | 发起打赏 |
| ShareDialog | (内部) | 分享 |
| RepostDialog | onClick={handleToggleUser} | 选择转发对象 |
| RepostDialog | onClick={handleConfirm} | 确认转发 |
| RepostDialog | onClick={handleClose} | 关闭 |

### 5. 商品 (Product)
| 文件 | 事件 | 说明 |
|------|------|------|
| ProductCardView | onClick={handleCardClick} | 商品卡片点击 |
| ProductCardView | onClick={handleReport} | 举报商品 |
| ProductCardView | onClick={actions.openProduct} | 打开商品 |
| ProductCardView | onClick={actions.copyLink} | 复制链接 |
| ProductCardView | onClick={actions.addToCart} | 加购 |
| ProductCardView | onClick={actions.buyNow} | 立即购买 |
| ProductCardView | onClick (收藏按钮) | 收藏商品 |
| seller/products/create | onClick={handleImageSelect} (通过 label) | 选择商品图 |
| seller/products/create | onClick={() => removeImage(index)} | 移除图片 |
| seller/products/edit | onClick={() => removeExistingImage(index)} | 移除已有图 |
| seller/products/edit | onClick={() => removeImage(index)} | 移除新图 |
| seller/affiliate-settings | onClick={handleSelectAll} | 全选 |
| seller/affiliate-settings | onClick={() => handleBatchToggle(true/false)} | 批量开关 |
| seller/affiliate-settings | onClick={handleBatchSetCommission} | 批量设置佣金 |
| seller/affiliate-settings | onClick={() => handleSaveProduct(product.id)} | 保存商品 |

### 6. 购物车与结账
| 文件 | 事件 | 说明 |
|------|------|------|
| ShoppingCart | onClick={clearCart} | 清空购物车 |
| ShoppingCart | onClick={() => updateQuantity(..., qty-1)} | 减少数量 |
| ShoppingCart | onClick={handleIncreaseQuantity} | 增加数量 |
| AddressSelector | onClick={() => onSelectAddress(address)} | 选择地址 |
| AddressSelector | onClick={handleAddAddress} | 添加地址 |
| AddressSelector | onClick={() => setShowForm(true)} | 显示地址表单 |
| checkout/page | (通过 AddressSelector) | 地址选择 |

### 7. 订单
| 文件 | 事件 | 说明 |
|------|------|------|
| orders/[id]/feedback | onClick={() => setRating(star)} | 设置评分 |
| orders/[id]/feedback | onClick={() => router.push(...)} | 返回订单 |
| orders/[id]/pay | (支付按钮) | 发起支付 |

### 8. 订阅
| 文件 | 事件 | 说明 |
|------|------|------|
| subscription/seller | onClick={handleSubscribe} | 订阅卖家 |
| subscription/affiliate | (订阅按钮) | 订阅带货 |
| subscription/tip | (订阅按钮) | 订阅打赏 |
| subscription/success | onClick (关闭弹窗) | 关闭支付账户弹窗 |
| subscription/manage | onClick={() => setShowHistory(!showHistory)} | 展开/收起历史 |

### 9. 收藏
| 文件 | 事件 | 说明 |
|------|------|------|
| FavoriteItem | onClick={handleRemove} | 移除收藏 |
| FavoriteItem | onClick={onSelect} | 选择收藏项 |
| FavoriteItem | onClick={() => setShowNotesDialog(true)} | 编辑备注 |
| FavoriteItem | onClick={handleRemove} | 删除收藏 |

### 10. 聊天与消息
| 文件 | 事件 | 说明 |
|------|------|------|
| CreateConversation | onClick={onClose} | 关闭弹窗 |
| CreateConversation | onClick={() => handleCreateConversation(otherUser.id)} | 创建会话 |
| ChatWindow | (表单 submit) | 发送消息 |
| MessageBubble | DropdownMenuItem onClick (撤回) | 撤回消息 |
| MessageBubble | DropdownMenuItem onClick (删除) | 删除消息 |
| MessageBubble | DropdownMenuItem onClick (翻译) | 翻译消息 |
| MessageBubble | DropdownMenuItem onClick (举报) | 举报消息 |
| CreateGroup | (checkbox) onChange | 选择群成员 |

### 11. 侧边栏与导航
| 文件 | 事件 | 说明 |
|------|------|------|
| Sidebar | onClick={handleLinkClick} | 导航链接 |
| Sidebar | onClick={onClose} | 关闭侧栏 |
| Sidebar | onClick={() => setIsMoreMenuOpen(...)} | 更多菜单 |
| Sidebar | 各菜单项 onClick | 新建聊天、创建群组、订阅等 |

### 12. 地址管理
| 文件 | 事件 | 说明 |
|------|------|------|
| profile/addresses | onClick={handleCancelEdit} | 取消编辑 |
| profile/addresses | onClick={handleSaveEdit} | 保存编辑 |
| profile/addresses | onClick={() => setDefaultMutation.mutate(...)} | 设为默认 |
| profile/addresses | onClick={() => handleEdit(address)} | 编辑地址 |
| profile/addresses | onClick (删除) | 删除地址 |

### 13. 浏览历史
| 文件 | 事件 | 说明 |
|------|------|------|
| profile/[id]/history | onClick={() => setShowClearConfirm(true)} | 显示清空确认 |
| profile/[id]/history | onClick={handleClearHistory} | 清空历史 |

### 14. 管理员
| 文件 | 事件 | 说明 |
|------|------|------|
| ContentReview | onClick={() => handleReview(..., 'approved')} | 通过审核 |
| ContentReview | onClick={() => handleReview(..., 'rejected')} | 驳回审核 |
| ProfileReviewClient | onClick={() => handleApprove(p.id)} | 通过资料 |
| ProfileReviewClient | onClick={() => handleReject(p.id)} | 驳回资料 |
| ReportManagement | onClick (删除内容/通过/驳回) | 举报处理 |
| AdminSupportClient | onClick (分配/关闭/升级) | 工单操作 |
| AdminDisputeClient | (表单) | 纠纷处理 |
| AdminViolationPenaltiesClient | (表单提交) | 违规扣款 |
| AdminPlatformFeesClient | (表单) | 平台费用 |
| AdminSellerDebtsClient | (搜索) | 卖家欠款 |
| AdminPaymentAccountsClient | (验证备注) | 支付账户验证 |

### 15. 其他
| 文件 | 事件 | 说明 |
|------|------|------|
| ImageUpload | onClick={() => removeImage(index)} | 移除预览图 |
| ImageUpload | onClick={uploadImages} | 上传图片 |
| OnboardingGuide | onClick={handlePrevious/Next/Skip} | 引导步骤 |
| feed/page, HomePageClient, page | onClick={() => fetchNextPage()} | 加载更多 |
| topics/[topic] | onClick={() => fetchNextPage()} | 加载更多 |
| seller/analytics | onClick={() => setTimeRange(7/30/90)} | 切换时间范围 |
| affiliate/products/[id]/promote | onClick={() => router.back()} | 返回 |
| support/tickets/create | onClick={() => router.back()} | 返回 |
| support/tickets/[id] | onClick={() => router.back()} | 返回 |

---

## 二、输入事件 (onChange / onInput / onSubmit)

### 1. 认证
| 文件 | 事件 | 字段 |
|------|------|------|
| login/page | onChange | email, password |
| login/page | onSubmit | 登录表单 |
| register/page | onChange | username, email, password |
| register/page | onSubmit | 注册表单 |
| forgot-password | onChange | email |
| forgot-password | onSubmit | 找回密码 |
| reset-password | onChange | password, confirmPassword |
| reset-password | onSubmit | 重置密码 |

### 2. 帖子
| 文件 | 事件 | 字段 |
|------|------|------|
| post/create | onChange | content, location, newTopic |
| post/create | onSubmit | 发布帖子 |

### 3. 评论
| 文件 | 事件 | 字段 |
|------|------|------|
| CommentSection | onChange | newComment, editingContent, replyContent |
| CommentSection | onSubmit | 提交评论、回复 |
| ProductCommentSection | onChange | newComment, editingContent, replyContent |
| ProductCommentSection | onSubmit | 提交评论、回复 |

### 4. 商品
| 文件 | 事件 | 字段 |
|------|------|------|
| seller/products/create | onChange | name, description, details, price, currency, stock, category, allow_affiliate, commission_rate |
| seller/products/create | onSubmit | 创建商品 |
| seller/products/edit | onChange | (同上) |
| seller/products/edit | onSubmit | 更新商品 |
| seller/affiliate-settings | onChange | commission_rate (每商品) |
| seller/policies | onChange | returnPolicy, exchangePolicy, shippingPolicy, contactInfo |

### 5. 地址
| 文件 | 事件 | 字段 |
|------|------|------|
| profile/addresses | onChange | label, recipient_name, phone, country, state, city, street_address, postal_code, is_default |
| AddressSelector | onChange | (新增地址表单各字段) |
| orders/[id]/pay | onChange | shippingAddress 各字段, bankFormData |

### 6. 支付与结账
| 文件 | 事件 | 字段 |
|------|------|------|
| checkout/page | onSelect | selectedPaymentMethod |
| orders/[id]/pay | onChange | 收货地址、银行转账表单 |
| PaymentMethodSelector | onChange/onClick | 选择支付方式 |
| TipButton / UserTipButton | onChange | amount |

### 7. 聊天
| 文件 | 事件 | 字段 |
|------|------|------|
| ChatWindow | onChange | newMessage |
| ChatWindow | onSubmit | 发送消息 |
| CreateConversation | onChange | searchQuery |
| CreateGroup | onChange | name, description |
| CreateGroup | onChange (checkbox) | 选择成员 |

### 8. 推广/带货
| 文件 | 事件 | 字段 |
|------|------|------|
| affiliate/products/[id]/promote | onChange | 推广内容 |
| affiliate/products/[id]/promote | onSubmit | 创建推广帖 |

### 9. 支持工单
| 文件 | 事件 | 字段 |
|------|------|------|
| support/tickets/create | onChange | title, description, priority 等 |
| support/tickets/create | onSubmit | 创建工单 |
| TicketDetailClient | onChange | replyText |
| TicketDetailClient | onSubmit | 回复工单 |
| AdminSupportClient | onChange | 筛选/分配等 |

### 10. 资料与设置
| 文件 | 事件 | 字段 |
|------|------|------|
| profile/[id]/edit | onChange | display_name, bio, location 等 |
| profile/[id]/edit | onSubmit | 保存资料 |

### 11. 订单反馈
| 文件 | 事件 | 字段 |
|------|------|------|
| orders/[id]/feedback | onChange | comment |
| orders/[id]/feedback | onSubmit | 提交评价 |

### 12. 举报
| 文件 | 事件 | 字段 |
|------|------|------|
| ReportDialog | onChange | description |
| ReportDialog | (提交) | 举报表单 |

### 13. 搜索
| 文件 | 事件 | 字段 |
|------|------|------|
| search/page | onChange | query |
| search/page | onSubmit | 搜索 |

### 14. 管理员表单
| 文件 | 事件 | 字段 |
|------|------|------|
| AdminDisputeClient | onChange | resolution, refundAmount, refundMethod |
| AdminViolationPenaltiesClient | onChange | sellerId, amount, relatedOrderId, violationReason 等 |
| AdminPlatformFeesClient | onChange | userId, amount, currency, reason, searchUserId |
| AdminPlatformPaymentAccounts | onChange | stripeSecretKey, paypalClientId 等 |
| PlatformPaymentAccountForm | onChange | 各支付渠道配置 |

### 15. 选择器 (onValueChange / onSelect)
| 文件 | 事件 | 说明 |
|------|------|------|
| subscription/seller | onSelect | 支付方式 |
| subscription/affiliate | onSelect | 支付方式 |
| subscription/tip | onSelect | 支付方式 |
| checkout/page | onSelect | 支付方式 |
| deposit/pay | onSelect | 支付方式 |
| AdminSellerDebtsClient | onValueChange | filterStatus |
| AdminPlatformFeesClient | onValueChange | currency, paymentMethod |
| PaymentMethodSelector | onSelect | 支付方式 ID |

---

## 三、选择图片事件 (type="file" accept="image/*")

| 文件 | 说明 |
|------|------|
| [components/ui/ImageUpload.tsx](src/components/ui/ImageUpload.tsx) | 通用图片上传组件，`onChange={handleFileSelect}`，accept="image/jpeg,image/jpg,image/png,image/gif,image/webp" |
| [app/(main)/post/create/page.tsx](src/app/[locale]/(main)/post/create/page.tsx) | 帖子图片，`onChange={handleImageSelect}` |
| [app/(main)/seller/products/create/page.tsx](src/app/[locale]/(main)/seller/products/create/page.tsx) | 商品图片，`onChange={handleImageSelect}` |
| [app/(main)/seller/products/[id]/edit/page.tsx](src/app/[locale]/(main)/seller/products/[id]/edit/page.tsx) | 商品编辑图片，`onChange={handleImageSelect}` |
| [app/(main)/profile/[id]/edit/page.tsx](src/app/[locale]/(main)/profile/[id]/edit/page.tsx) | 头像/资料图片，`onChange={handleImageSelect}` |
| [components/social/CommentSection.tsx](src/components/social/CommentSection.tsx) | 评论图片（主评论 + 回复），`onChange={newCommentImageUpload.handleImageSelect}` / `replyImageUpload?.handleImageSelect`，或通过 `fileInputRef.current?.click()` 触发 |
| [components/ecommerce/ProductCommentSection.tsx](src/components/ecommerce/ProductCommentSection.tsx) | 商品评论图片，`onChange={newCommentImageUpload.handleImageSelect}` / `replyImageUpload?.handleImageSelect` |
| [app/(main)/orders/[id]/pay/page.tsx](src/app/[locale]/(main)/orders/[id]/pay/page.tsx) | 银行转账凭证，`type="file" accept="image/*"` |
| [components/ecommerce/ProductReviewForm.tsx](src/components/ecommerce/ProductReviewForm.tsx) | 商品评价图片，`type="file" accept="image/*"` |

---

## 四、事件统计摘要

| 类型 | 数量级 |
|------|--------|
| 点击 (onClick) | ~200+ |
| 输入 (onChange/onSubmit) | ~80+ |
| 选择图片 (file input) | 9 处 |
| 选择器 (onSelect/onValueChange) | ~15 |

---

## 五、按页面/模块快速索引

| 模块 | 点击 | 输入 | 图片 |
|------|------|------|------|
| 认证 | 1 | 4 表单 | - |
| 帖子 | 15+ | 3 | 1 |
| 评论 | 15+ | 6 | 2 |
| 商品 | 15+ | 10+ | 3 |
| 购物车/结账 | 5+ | 2 | - |
| 订单 | 3+ | 2 | 1 |
| 订阅 | 5+ | - | - |
| 打赏 | 3+ | 2 | - |
| 收藏 | 4+ | - | - |
| 聊天 | 5+ | 4 | - |
| 侧边栏 | 10+ | - | - |
| 地址 | 5+ | 15+ | - |
| 管理员 | 20+ | 15+ | - |
| 资料编辑 | - | 5+ | 1 |
| 工单 | 2+ | 5+ | - |
| 举报 | - | 1 | - |
| 搜索 | - | 2 | - |
