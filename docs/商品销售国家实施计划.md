# 商品销售国家/地区实施计划

**目标**：为商品增加「销售到的国家和地区（主要国家）」字段，在创建/编辑商品时可选择，并能记住选择。

---

本计划拆分为 5 个文档：

1. **[01-数据库与规则](./商品销售国家-01-数据库与规则.md)** — 概述、表结构、存储格式、迁移、类型定义
2. **[02-常量与UI组件](./商品销售国家-02-常量与UI组件.md)** — 国家列表常量、选择器组件、翻译
3. **[03-创建页与编辑页](./商品销售国家-03-创建页与编辑页.md)** — 创建页、编辑页、详情展示、记住选择逻辑
4. **[04a-多语言补丁](./商品销售国家-04a-多语言补丁.md)** — SalesCountriesSelector 组件多语言补丁
5. **[04b-详情页与区块补丁](./商品销售国家-04b-详情页与区块补丁.md)** — 详情页旧数据兼容、区块标题与说明

---

## 一、当前代码现状

| 位置 | 状态 | 说明 |
|------|------|------|
| 编辑页 formData | 有 | `sales_countries: []`，从 product 加载 |
| 编辑页 productData 提交 | **缺失** | 未将 `sales_countries` 写入 update |
| 编辑页 UI | **缺失** | 无国家选择控件 |
| 创建页 | **缺失** | 无 formData、无 UI、无 productData |
| 数据库 products 表 | **缺失** | 无 `sales_countries` 列 |
| database.ts | **缺失** | 无类型定义 |
| 国家常量 | **缺失** | 项目无现成国家列表（曾被删除的 `@/lib/constants/sales-countries`） |

---

## 二、需求说明

- **销售国家**：商品支持配送/销售到的国家/地区（主要国家列表）
- **创建页**：可多选国家，选择结果保存到商品
- **记住选择**：
  - 主：每商品独立保存 `sales_countries` 到数据库
  - 辅：创建新商品时，用 localStorage 记住上次选择作为默认值，减少重复勾选

---

## 三、核心规则

- 存储格式：ISO 3166-1 alpha-2 国家代码（如 `CN`、`US`、`JP`）
- 空数组 `[]`：未限制，表示全球可售
- 非空数组：仅限所列国家可售
- 主要国家：约 30–50 个常用电商目的地，中英双语展示

---

## 四、推荐实施顺序

| 步骤 | 文档 | 操作 |
|------|------|------|
| 1 | 01 | 数据库迁移、类型定义 |
| 2 | 02 | 国家常量、选择器组件、翻译 |
| 3 | 03 | 创建页、编辑页、详情展示、记住选择 |
